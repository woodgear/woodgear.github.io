<!DOCTYPE html>
            <html>
            <head>
            <meta charset="utf-8"/>
            <link rel="stylesheet" href="..\..\common/default/style.css">
            <link rel="stylesheet" href="..\..\common/highlight/styles/solarized-dark.css">
            <link rel="stylesheet" type="text/css" href="..\..\common/math/katex/katex.min.css">
            <link rel="stylesheet" type="text/css" href="..\..\common/label/label.min.css">
            <script src="..\..\common/script/util.js"></script>
            <title>翻墙</title>
            </head>
            <body>
            <div class="content">
            <header id="meta">
        <div id="tag" class="ui labels">
        <a class="ui label" id="time_ago">Tue Jan 29 2019 22:50:46 GMT+0800 (GMT+08:00)</a>
        <a class="ui label">器</a>
        
        </div>
    </header>
            <article>
            <h1>简介</h1>
<p>本篇描述在已有shadowsockes server的情况下配置翻墙环境 达到开机自启 无感翻墙的效果
<br>
环境为ubuntu16.04 ubuntu其他版本和其他Unix操作系统可参照类似操作</p>
<h1>基本步骤</h1>
<ul><li><p>通过shadowsockes 开启sock5 proxy</p></li>
<li><p>通过go proxy 将http/https协议代理转发成sock5 </p></li>
<li><p>通过systemd设置service 将shadowsockes和go proxy 开机自启</p></li>
<li><p>让浏览器和terminal使用代理</p>
<h1>shadowsockes</h1></li>
<li><p>买一个帐号 或者 自己搭vps</p></li>
<li><p>下载sslocal(shadowsockes client) 推荐 
<a href="https://github.com/shadowsocks/shadowsocks-rust/releases">shadowsocks-rust</a>
standalone 比较省心 支持多个server的负载均衡 直接下载解压 丢到 /uer/bin</p>
<h1>go proxy</h1>
<p>目前http/https->sock5的软件有 
<a href="https://www.irif.fr/~jch//software/polipo/">polipo</a>
 
<a href="https://www.privoxy.org/">privoxy</a>
  
<a href="https://github.com/snail007/goproxy">goproxy</a>
.</p></li>
</ul>
<ul><li><p>polipo:已经死了</p></li>
<li><p>privoxy:并不是专业的 不纯粹 不好用</p></li>
<li><p>goproxy:简单粗暴 专业proxy 推荐使用
安装完成后 通过如下配置文件在8118 端口开启http/https代理</p></li>
</ul>
<pre class="hlcode"><code>sps
--parent-service-type=socks
--parent-type=tcp
--parent=127.0.0.1:1080
--<span class="hljs-built_in">local</span>-type=tcp
--<span class="hljs-built_in">local</span>=0.0.0.0:8118<code></pre>
<h1>开机自启</h1>
<p>ubuntu 有service机制可以配置开机自启的命令
首先要准备好shadowsocks和proxy service的配置文件
接着要通过这些配置文件创建出自启的service</p>
<h2>service配置文件(以shadowsocks-client.service 为例)</h2>
<pre class="hlcode"><code>[Unit]
Description=Shadowsocks Client
After=network.target

[Service]
ExecStart= <span class="hljs-variable">$sslocal_absolute_path</span> -c <span class="hljs-variable">$shadowsocks_config_json_absolute_path</span>

[Install]
WantedBy=multi-user.target<code></pre>
<h2>创建service脚本(install-service.sh)</h2>
<pre class="hlcode"><code><span class="hljs-meta">#!/bin/bash</span>
service=<span class="hljs-string">"<span class="hljs-variable">$1</span>"</span>
cp <span class="hljs-variable">$service</span>.service /etc/systemd/system/<span class="hljs-variable">$service</span>.service

systemctl <span class="hljs-built_in">enable</span> <span class="hljs-variable">$service</span>
systemctl start <span class="hljs-variable">$service</span><code></pre>
<h2>删除service脚本</h2>
<pre class="hlcode"><code><span class="hljs-meta">#!/bin/bash</span>
service=<span class="hljs-variable">$1</span>

systemctl stop <span class="hljs-variable">$service</span>.service
systemctl <span class="hljs-built_in">disable</span> <span class="hljs-variable">$service</span>.service
rm /etc/systemd/system/<span class="hljs-variable">$service</span>.service
rm /etc/init.d/<span class="hljs-variable">$service</span>.service
systemctl daemon-reload<code></pre>
<h2>创建自启shadowsocks-clientservice proxy服务</h2>
<p>调用</p>
<ul><li><p>sudo ./install-service.sh shadowsocks-client </p></li>
<li><p>sudo ./install-service.sh proxy</p></li>
</ul>
<h1>使用代理</h1>
<p>有图形化界面的话直接在System Settings->Network->Network proxy 中设置 </p>
<p>Method选Manual,设置 http/https Proxy  地址127.0.0.1 端口8118</p>
<p>没有就在~/.bashrc(bash)或~/.zshrc(zsh) 增加环境变量</p>
<pre class="hlcode"><code><span class="hljs-built_in">export</span> http_proxy=http://127.0.0.1:8118/
<span class="hljs-built_in">export</span> https_proxy=https://127.0.0.1:8118/<code></pre>
<h2>浏览器</h2>
<p>可以让浏览器直接使用系统代理 或者安装SwitchyOmega来让浏览器通过代理上网</p>
            </article>
            </div>
            <body>
            <script src="..\..\common/script/fix.js"></script>
            </html>