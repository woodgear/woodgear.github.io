{"componentChunkName":"component---src-templates-blog-post-js","path":"/cube/winpcap/","result":{"data":{"markdownRemark":{"html":"<h1>检查安装</h1>\n<p>去控制面板看 <a href=\"https://www.winpcap.org/misc/faq.htm#Q-1\">https://www.winpcap.org/misc/faq.htm#Q-1</a></p>\n<h1>原理</h1>\n<p>一个新数据包到来的事件通过<code class=\"language-text\">Packet_tap</code>通知NPF\n在IoCreateDevice 可以指定DEVICE<em>EXTENSION的大小,然后就可以用这个空间初始化自己的DEVICE</em>EXTENSION了</p>\n<p>通过DeviceIoCtontrol 将ReadEvent发送到驱动中</p>\n<p>npf<em>open 打开一个适配器 然后如果有流量进来才会调用npf</em>tap 第一个参数 ProtocolBindingContext 实际上是我们OpenAdapter时自己定义的</p>\n<p>读取时的ReadTimeout 实际上是设置给WaitForsingleObject的如果没设 就会用INFIINTE,直到驱动设置了ReadEvent的状态 真正读取内容时还是直接到ReadFile来做</p>"}},"pageContext":{"slug":"/cube/winpcap/"}}}