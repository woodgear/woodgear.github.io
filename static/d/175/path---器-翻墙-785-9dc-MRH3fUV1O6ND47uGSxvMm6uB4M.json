{"data":{"markdownRemark":{"html":"<h1>简介</h1>\n<p>本篇描述在已有shadowsockes server的情况下配置翻墙环境 达到开机自启 无感翻墙的效果<br>\n环境为ubuntu16.04 ubuntu其他版本和其他Unix操作系统可参照类似操作</p>\n<h1>基本步骤</h1>\n<ol>\n<li>通过shadowsockes 开启sock5 proxy</li>\n<li>通过go proxy 将http/https协议代理转发成sock5 </li>\n<li>通过systemd设置service 将shadowsockes和go proxy 开机自启</li>\n<li>\n<p>让浏览器和terminal使用代理</p>\n<h1>shadowsockes</h1>\n</li>\n<li>买一个帐号 或者 自己搭vps</li>\n<li>\n<p>下载sslocal(shadowsockes client) 推荐 <a href=\"https://github.com/shadowsocks/shadowsocks-rust/releases\">shadowsocks-rust</a>standalone 比较省心 支持多个server的负载均衡 直接下载解压 丢到 /uer/bin</p>\n<h1>go proxy</h1>\n<p>目前http/https->sock5的软件有 <a href=\"https://www.irif.fr/~jch//software/polipo/\">polipo</a> <a href=\"https://www.privoxy.org/\">privoxy</a>  <a href=\"https://github.com/snail007/goproxy\">goproxy</a>.</p>\n</li>\n<li>polipo:已经死了</li>\n<li>privoxy:并不是专业的 不纯粹 不好用</li>\n<li>\n<p>goproxy:简单粗暴 专业proxy 推荐使用\n安装完成后 通过如下配置文件在8118 端口开启http/https代理</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">sps\n--parent-service-type<span class=\"token operator\">=</span>socks\n--parent-type<span class=\"token operator\">=</span>tcp\n--parent<span class=\"token operator\">=</span>127.0.0.1:1080\n--local-type<span class=\"token operator\">=</span>tcp\n--local<span class=\"token operator\">=</span>0.0.0.0:8118</code></pre></div>\n<h1>开机自启</h1>\n<p>ubuntu 有service机制可以配置开机自启的命令\n首先要准备好shadowsocks和proxy service的配置文件\n接着要通过这些配置文件创建出自启的service</p>\n<h2>service配置文件(以shadowsocks-client.service 为例)</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">[</span>Unit<span class=\"token punctuation\">]</span>\nDescription<span class=\"token operator\">=</span>Shadowsocks Client\nAfter<span class=\"token operator\">=</span>network.target</code></pre></div>\n</li>\n</ol>\n<p>[Service]\nExecStart= $sslocal<em>absolute</em>path -c $shadowsocks<em>config</em>json<em>absolute</em>path</p>\n<p>[Install]\nWantedBy=multi-user.target</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">## 创建service脚本(install-service.sh)\n```bash\n#!/bin/bash\nservice=&quot;$1&quot;\ncp $service.service /etc/systemd/system/$service.service\n\nsystemctl enable $service\nsystemctl start $service</code></pre></div>\n<h2>删除service脚本</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token shebang important\">#!/bin/bash</span>\nservice<span class=\"token operator\">=</span><span class=\"token variable\">$1</span>\n\nsystemctl stop <span class=\"token variable\">$service</span>.service\nsystemctl disable <span class=\"token variable\">$service</span>.service\n<span class=\"token function\">rm</span> /etc/systemd/system/<span class=\"token variable\">$service</span>.service\n<span class=\"token function\">rm</span> /etc/init.d/<span class=\"token variable\">$service</span>.service\nsystemctl daemon-reload</code></pre></div>\n<h2>创建自启shadowsocks-clientservice proxy服务</h2>\n<p>调用</p>\n<ul>\n<li>sudo ./install-service.sh shadowsocks-client </li>\n<li>sudo ./install-service.sh proxy</li>\n</ul>\n<h1>使用代理</h1>\n<p>有图形化界面的话直接在System Settings->Network->Network proxy 中设置 </p>\n<p>Method选Manual,设置 http/https Proxy  地址127.0.0.1 端口8118</p>\n<p>没有就在~/.bashrc(bash)或~/.zshrc(zsh) 增加环境变量</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">export</span> http_proxy<span class=\"token operator\">=</span>http://127.0.0.1:8118/\n<span class=\"token function\">export</span> https_proxy<span class=\"token operator\">=</span>https://127.0.0.1:8118/</code></pre></div>\n<h2>浏览器</h2>\n<p>可以让浏览器直接使用系统代理 或者安装SwitchyOmega来让浏览器通过代理上网</p>"}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/器/翻墙/"}}