{"data":{"markdownRemark":{"html":"<h1>install</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> qemu qemu-kvm libvirt-bin  bridge-utils  virt-manager\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> libvirtd start\n<span class=\"token function\">sudo</span> update-rc.d libvirtd <span class=\"token function\">enable</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h1>windows-virtio</h1>\n<p><a href=\"https://linuxhint.com/install_virtio_drivers_kvm_qemu_windows_vm/\">https://linuxhint.com/install<em>virtio</em>drivers<em>kvm</em>qemu<em>windows</em>vm/</a></p>\n<h1>tips</h1>\n<h2>virsh start need root priva</h2>\n<h2>network-default-is-not-active</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">// 手动启动\n<span class=\"token function\">sudo</span> <span class=\"token function\">virsh</span> net-start default\n// 设置为自动启动\n<span class=\"token function\">virsh</span> net-autostart default</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>virt-viewer connect error</h2>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">virt-viewer test-win10\n<span class=\"token comment\"># Failed to connect: no virtual machine found</span>\n<span class=\"token function\">nohup</span> virt-viewer -c qemu:///system test-win10 <span class=\"token operator\">&amp;</span>\n<span class=\"token comment\"># that's fine</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>libvirt</h1>\n<blockquote>\n<p>libvirt提供了跨VM平台的功能，它可以控制除了QEMU之外的模拟器，包括vmware, virtualbox， xen等等</p>\n</blockquote>\n<h1>network</h1>\n<h2>network source</h2>\n<h2>device model</h2>\n<h1>concept</h1>\n<p>self:kvm\nvirsh virt-manager libvirt qemu</p>\n<p>win10专业版激活码：RJ4PG-K9RW2-B648D-WYGFC-VR479</p>\n<h1>cpu</h1>\n<p>current alloction # 这个虚拟机允许被用线程数 = socket<em>core</em>thread\nsocket #主板上有几个cpu接口\ncore   #一个cpu上有几核\nthread   #一核能开多少线程</p>\n<h1>复制粘贴</h1>\n<h2>windows</h2>\n<p>安装<a href=\"https://www.spice-space.org/download/windows/spice-guest-tools/spice-guest-tools-latest.exe\">spice-guest-tools</a></p>\n<h1>virsh</h1>\n<h2>list all vm</h2>\n<p>virsh --list # list all active vm\nvirsh --list # list all vm</p>\n<h1>network</h1>\n<p>要想guest之间能够互相连接,需要使用bridge模式\n大致的模型为 将电脑视为虚拟的交换器 实体机和虚拟机都是连接到此虚拟机上的电脑</p>\n<ol>\n<li>建立虚拟的网桥</li>\n<li>连接实体机</li>\n<li>连接虚拟机</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">// 增加一个bridge 名字是bro\nnmcli connection add type bridge ifname br0 stp no\n// 查看所有的connection 可以用来确认上面的命令   \nnmcli connection\n// 将真实的物理网卡设为此bridge的 slave \nnmcli con add type bridge-slave ifname eno1 master br0\n// 启动此bridge 这样我们就可以将虚拟机连接到此 bridge上\nnmcli con up br0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h2>virt-manager</h2>\n<p>之后在virt-manager中将虚拟机的network设备 设为 spcial device name br0即可</p>\n<h2>qemu</h2>\n<p><a href=\"https://www.qemu.org/2018/05/31/nic-parameter/\">nic</a></p>\n<h1>kvm 双屏显示</h1>\n<p>增加Video QXL的硬件 使用virt-viewer连接 即可\n会跳出来两个窗口 使用 <code class=\"language-text\">--full-screen=auto-conf</code> 自动全屏</p>","fields":{"slug":"/cube/kvm/","disqus":{"shortname":"woodgear-blog"}},"frontmatter":{"id":"4g3gt5w","time":"1996-09-08T23:37:07+08:00","tag":null},"parent":{"__typename":"File","name":"kvm","ext":".md","birthTime":"1970-01-01T00:00:00.000Z","changeTime":"2020-09-26T05:06:55.226Z","relativeDirectory":"cube","absolutePath":"/home/oaa/ns/share/blog/cube/kvm.md"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/cube/kvm/","disqus":{"shortname":"woodgear-blog"}}}