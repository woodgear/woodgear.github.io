{"data":{"markdownRemark":{"html":"<h1>安装</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -O https://dl.google.com/dl/cloudsdk/channels/rapid/downloads/google-cloud-sdk-245.0.0-linux-x86_64.tar.gz\n<span class=\"token comment\"># 20191229 google-cloud-sdk-245.0.0-linux-x86_64.tar.gz md5 6c824a4760f3bd58c3bcc40a689dfc42</span>\n<span class=\"token function\">tar</span> zxvf google-cloud-sdk-245.0.0-linux-x86_64.tar.gz google-cloud-sdk\n./google-cloud-sdk/install.sh\n<span class=\"token comment\"># 执行完成之后要重启terminal</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<h1>配置kubectl</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">#理论上讲自己直接装也是可以的</span>\ngcloud components <span class=\"token function\">install</span> kubectl\n<span class=\"token comment\"># 首先要有一个project gcloud projects list 列出id</span>\ngcloud config <span class=\"token keyword\">set</span> project project-id\n<span class=\"token comment\"># gcloud container clusters list # list cluster</span>\n<span class=\"token comment\"># gcloud container clusters get-credentials $CLUSTER_NAME --region $REGION</span>\ngcloud container clusters get-credentials standard-cluster-1 --region us-central1-a\n\n<span class=\"token comment\"># 然后用可以通过kubectl 验证一下</span>\nkubectl config get-contexts\nkubectl get po</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>必须开代理设置http(s)_proxy 环境变量</p>\n<h1>销毁</h1>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-text line-numbers\"><code class=\"language-text\">gcloud projects delete PROJECT_ID</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h1>扩容</h1>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\"><span class=\"token comment\">#gcloud compute disks resize $DISK_NAME $NEW_DISK_SIZE --zone $ZONE</span>\ngcloud compute disks resize vh-dict 2GB --zone us-central1-a</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>不过好像有个bug 重启之后kubectl pod中的container(docker)好像并没有自动识别到扩容后的磁盘 lsblk 是正常的但是df -h 还是不对<br>\n震惊  <code class=\"language-text\">New disk size &#39;1&#39; GiB must be larger than existing size &#39;2&#39; GiB.</code></p>","fields":{"slug":"/tech-share/google-cloud/","disqus":{"shortname":"woodgear-blog"}},"frontmatter":{"id":"d0eyolv","time":"2019-12-29T11:11:02+08:00","tag":null},"parent":{"__typename":"File","name":"google-cloud","ext":".md","birthTime":"1970-01-01T00:00:00.000Z","changeTime":"2020-11-26T15:06:22.336Z","relativeDirectory":"tech-share","absolutePath":"/home/oaa/ns/share/blog/tech-share/google-cloud.md"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/tech-share/google-cloud/","disqus":{"shortname":"woodgear-blog"}}}